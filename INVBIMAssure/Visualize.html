<!DOCTYPE html>
<!-- saved from url=(0042)http://localhost:3000/files/3929/visualize -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="BimAssure">
    <meta name="author" content="BimAssure">
    
    <title>Visualize</title>
    
    <style>.file-input-wrapper { overflow: hidden; position: relative; cursor: pointer; z-index: 1; }.file-input-wrapper input[type=file], .file-input-wrapper input[type=file]:focus, .file-input-wrapper input[type=file]:hover { position: absolute; top: 0; left: 0; cursor: pointer; opacity: 0; filter: alpha(opacity=0); z-index: 99; outline: 0; }.file-input-name { margin-left: 8px; }</style>
    <script src="./Visualize_files/jquery.js"></script>
    <style>
    .xos-viz-view3d {
      position: absolute;
      margin: 0px;
      padding: 0px;
      left: 0px;
      top: 0px;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    </style>
  <script src="./Visualize_files/webgl-viewer.js"></script><style type="text/css"></style>


<div id="viewer"></div>
<script>
    function loadViewer(url,modelId,at) {
           var container = document.getElementById("viewer");
           
           var viewer = new com.invicara.xos.viewer.WebGLViewer(container, {
                                                                showToolbar: false,
                                                                showSpinner: true,
                                                                authToken: at
                                                                });
             viewer.addEventListener("longTap", longTapHandler,false);
   
              
            var request = url +'model/' +modelId + '/view';
            viewer.loadModel(request).then(function(entities) {});
            
            window.viewer = viewer;
     
    };

        // Handler for "entitiesSelected" events
    var longTapHandler = function(event) {
     //   viewer.enableShadow (true);
       toggleEntitiesVisible();
        var entity = event.entity;
        // call back into the native app .
        //  "callbackFromWebPage" is the handler that the native app registered.
        // The function window.webkit.messageHandlers.<name>.postMessage(<messageBody>) is added to all frames
        // when the native app registered the callback function
        window.webkit.messageHandlers.callbackFromWebPage.postMessage(entity.id+";"+event.pageX +";"+event.pageY) 
    
    };

    function resetCamera() {
      viewer.resetCamera();
    };

    function enableShadow(enable) {
      viewer.enableShadow(enable);
    };

    function showLines(show) {
      viewer.showLines(show);
    };

    function setXRayMode(enable) {
        if (enable) {
            var all = viewer.getAllEntities();
            viewer.setEntitiesColor(all,0xFFFFFF,0.6);
        }
        else {
            var all = viewer.getAllEntities();
            viewer.resetEntitiesColor(all);
        }
    };

    function toggleEntitiesVisible() {
        var selected = viewer.getSelectedEntities();
        if (selected.length > 0) {
            viewer.setEntitiesVisible(selected, !selected[0].isVisible());
        }
    };
</script>


  
</body></html>